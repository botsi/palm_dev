var sivId,fadeinmovId,foimId,speedId,imp_style,old_chapter=chapter=0,wlh,folders,enumerateDaysBetweenDates=function(e,t){for(var a=[],i=e,n=function(e){var t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t};i<=t;)a.push(i),i=n.call(i,1);return a},write_day=function(e){e.parentNode.parentNode.previousSibling.classList.remove("form_check_white"),e.parentNode.parentNode.previousSibling.classList.add("form_check_blue"),e.parentNode.nextSibling.value=e.innerHTML+". "+adjustments_de.monthNames[avdays[getchildindex(e)-1].getMonth()]+" "+avdays[getchildindex(e)-1].getFullYear(),sh_dat.sh(e.parentNode,0),sh_dat.dis=!1,setTimeout(function(){sh_dat.dis=!0},1500)},sh_dat={dis:!0,sh:function(e,t){sh_dat.dis&&(0==t?(shop.time(e.nextSibling),e.classList.remove("tima_in"),e.classList.add("tima_out"),e.nextSibling.style.opacity=1):(sh_dat.highlight(e),e.classList.remove("tima_out"),e.classList.add("tima_in"),e.nextSibling.style.opacity=0))},highlight:function(e){for(var t=[],a=0;a<shop.items.length;a++)if(shop.items[a].Artikel.indexOf("Terminanfrage")!=-1){var t=shop.items[a].Artikel.replace("Terminanfrage für ","").split(" ");t[0]=t[0].replace(".","");break}if(0!=t.length)if(t[1]==e.children[0].innerHTML.split(" / ")[0])for(var a=1;a<e.children.length;a++)e.children[a].classList.remove("sel_day"),e.children[a].innerHTML==t[0]&&(e.children[a].classList.add("sel_day"),t[0]=0);else for(var a=e.children.length-1;a>0;a--)e.children[a].classList.remove("sel_day"),e.children[a].innerHTML==t[0]&&(e.children[a].classList.add("sel_day"),t[0]=0)},check:function(e){e.classList.contains("form_check_white")?sh_dat.sh(e.nextSibling.children[0],1):(e.nextSibling.children[1].value="",e.classList.remove("form_check_blue"),e.classList.add("form_check_white"),shop.time(e.nextSibling.children[1]))},file_proc:function(e){e.previousSibling.value=e.value.lastIndexOf("\\")==-1?e.value:e.value.slice(e.value.lastIndexOf("\\")+1)}},today=[new Date];today.push(new Date(today[0].getFullYear(),today[0].getMonth(),today[0].getDate()+3)),today.push(new Date(today[1].getFullYear(),today[1].getMonth()+1,today[1].getDate()));var avdays=enumerateDaysBetweenDates(today[1],today[2]),parent_media=function(e,t){sub_chapter(e.parentNode.parentNode.parentNode.parentNode.parentNode.nextSibling.getElementsByTagName("span")[t])},toggle_imp_run=function(e){e.focus(),"running"==e.style.animationPlayState||"running"==e.style.WebkitAnimationPlayState?(e.style.WebkitAnimationPlayState="paused",e.style.animationPlayState="paused"):(e.style.WebkitAnimationPlayState="running",e.style.animationPlayState="running")},sub_chapter=function(e){if(e.innerHTML.toLowerCase().indexOf("abschicken")!=-1)return void shop.preSendData();if(e.innerHTML.toLowerCase().indexOf("impressionen")!=-1){var t=document.getElementsByClassName("fa-eye")[folders[chapter].last_position];return t.ix=folders[chapter].last_position,see(t,1,-210),void window.scrollTo(0,t.parentNode.parentNode.nextSibling.offsetTop-102)}if(e.innerHTML.toLowerCase().indexOf("film")!=-1){var t=document.getElementsByClassName("fa-eye")[folders[chapter].last_position];return t.ix=folders[chapter].last_position,see(t,1,-210),window.scrollTo(0,t.parentNode.parentNode.nextSibling.offsetTop-102),void setTimeout(function(){show_video(folders[chapter].data[folders[chapter].last_position].epilog.Film)},500)}if(e.innerHTML.toLowerCase().indexOf("hören")!=-1)return void setTimeout(function(){hear_audio("images/"+folders[chapter].name,folders[chapter].data[folders[chapter].last_position].epilog.Hören)},500);set_epi_menu_color(e);var a=folders[chapter].data;switch(folders[chapter].data[folders[chapter].last_position].imp_cheese_state=!1,e.innerHTML){case"Einleitung":case"Kontakt":var i=""==a[folders[chapter].last_position].prolog?"":"<h2>"+a[folders[chapter].last_position].prolog+"</h2><br/><br/>";e.parentNode.previousSibling.innerHTML=i+a[folders[chapter].last_position].text,sh_cheese(e.parentNode.parentNode,0);break;case"Bestellung":e.parentNode.previousSibling.innerHTML=a[folders[chapter].last_position].epilog[e.innerHTML][0],sh_cheese(e.parentNode.parentNode,0);break;case"Impressum":if("old"==imp_style){e.parentNode.previousSibling.innerHTML="<dl>";for(var n in a[folders[chapter].last_position].epilog[e.innerHTML]){for(var s="",o=0;o<a[folders[chapter].last_position].epilog[e.innerHTML][n].length;o++){for(var l=!1,r=0;r<folders[0].data.length;r++)if(folders[0].data[r].name==a[folders[chapter].last_position].epilog[e.innerHTML][n][o].replace(" (palma3)","")){l=!0;break}var d=l?'<a onclick="search_nostyle(this)">'+a[folders[chapter].last_position].epilog[e.innerHTML][n][o]+"</a>":a[folders[chapter].last_position].epilog[e.innerHTML][n][o];s+="<dd>"+d+"</dd>"}e.parentNode.previousSibling.innerHTML+='<span class="inta"><dt>'+n+"</dt>"+s+"</span>"}e.parentNode.previousSibling.innerHTML+="</dl>"}else{folders[chapter].data[folders[chapter].last_position].imp_cheese_state=!0;var p='<div class="imp_abs"><div class="imp_slid">';for(var n in a[folders[chapter].last_position].epilog[e.innerHTML]){for(var s="",o=0;o<a[folders[chapter].last_position].epilog[e.innerHTML][n].length;o++){for(var l=!1,r=0;r<folders[0].data.length;r++)if(folders[0].data[r].name==a[folders[chapter].last_position].epilog[e.innerHTML][n][o].replace(" (palma3)","")){l=!0;break}var d=l?'<a onclick="search_nostyle(this)">'+a[folders[chapter].last_position].epilog[e.innerHTML][n][o]+"</a>":a[folders[chapter].last_position].epilog[e.innerHTML][n][o];s+='<p class="slid_imp_text">'+d+"</p>"}p+='<p class="slid_imp_title">'+n+"</p>"+s}p+="</div></div>";var c=e.parentNode.parentNode.offsetWidth,h=calc_min_slid_height(e.parentNode.children.length);1==e.parentNode.parentNode.getElementsByClassName("cheese").length&&e.parentNode.parentNode.removeChild(e.parentNode.parentNode.getElementsByClassName("cheese")[0]);var f=document.createElement("canvas");f.width=c,f.height=h,f.className="cheese",e.parentNode.parentNode.appendChild(f),e.parentNode.previousSibling.innerHTML=p;var m=e.parentNode.previousSibling.getElementsByClassName("imp_slid")[0];if(m.parentNode.style.margin="16px 0 10px 0",m.parentNode.style.height=h-110+"px",m.offsetHeight<e.parentNode.offsetHeight)m.classList.remove("imp_slid");else{var u=parseInt(m.offsetHeight/60)+"s";console.log(u),m.style.WebkitAnimationPlayState="running",m.style.animationPlayState="running",m.style.WebkitAnimationDuration=u,m.style.animationDuration=u,m.parentNode.addEventListener("mouseup",function(){toggle_imp_run(m)},!1)}sh_cheese(e.parentNode.parentNode,1)}break;default:var _="Orte und Daten"!=e.innerHTML?e.innerHTML:"Ausstellungsort";e.parentNode.previousSibling.innerHTML=a[folders[chapter].last_position].epilog[_],console.log("default sh_cheese"),sh_cheese(e.parentNode.parentNode,0)}e.parentNode.parentNode.getBoundingClientRect().top+e.parentNode.parentNode.offsetHeight>window.innerHeight&&window.scrollTo(0,e.parentNode.parentNode.offsetTop-210)},draw_cheese_canvas=function(e,t,a){var i=e.getContext("2d");i.fillStyle="rgba(255,255,255, 0.9)",i.fillRect(0,0,e.offsetWidth,e.offsetHeight),i.globalCompositeOperation="xor",i.fillStyle="#fff",i.fillRect(8,90,e.offsetWidth-198,e.offsetHeight-98),i.globalCompositeOperation="source-over",i.fillStyle="rgba(255,255,255, 0.3)",i.fillRect(8,90,e.offsetWidth-198,e.offsetHeight-98)},set_epi_menu_color=function(e){e.parentNode.children[0].style.visibility="inherit";for(var t=0;t<e.parentNode.children.length;t++)e.parentNode.children[t].style.background="rgba(141, 170, 212, 0.9)",e.parentNode.children[t].style.color="#333";e.style.background="rgba(0,0,0,0)",e.style.color="#bc123a"},get_column_count=function(e,t){if(window.innerWidth>950)var a="undefined"==typeof e.columns?"column-count:2":"column-count:"+e.columns;else var a="column-count:1";return a},aut=function(e){for(var t='<ul class="author">',a=0;a<e.length;a++){var i=e[a][5]===!0?'<a class="line" onclick="search_nostyle(this)">'+e[a][0]+"</a>":e[a][0],n=""==e[a][5]||e[a][5]===!0?"":'<a href="http://'+e[a][5]+'" target="_blank" >'+e[a][5]+"</a>",s=""==e[a][3]?"":" in "+e[a][3];t+="<li><span><p>"+i+"</p><p>"+e[a][1]+"</p><p>Geboren "+e[a][2]+s+"</p><p>Lebt in "+e[a][4]+"</p><p>"+n+"</p><p>"+e[a][6]+"</p></span></li>"}return t+="</ul>"},plc=function(e,t){for(var a='<ul class="orandda">',i=0;i<e.length;i++){if(""==e[i][0])if(t)if(t.till){var n=" "+t.from[2];t.from[2]==t.till[2]&&(n=""),e[i][0]=t.from[0]+". "+adjustments_de.monthNames[t.from[1]-1]+n+" bis "+t.till[0]+". "+adjustments_de.monthNames[t.till[1]-1]+" "+t.till[2]}else e[i][0]="Eröffnung: "+t.from[0]+". "+adjustments_de.monthNames[t.from[1]-1]+" "+t.from[2];else e[i][0]="&nbsp;";var s=""!=e[i][6]?'<a href="https://goo.gl/maps/'+e[i][6]+'" target="_blank" ><i class="fa fa-map-marker" aria-hidden="true"></i>':"<a>",o="";if(e[i][5].indexOf("www")!=-1||e[i][5].indexOf("blog")!=-1){var l=e[i][5].indexOf("/"),r=e[i][5].indexOf("/")!=-1?e[i][5].slice(0,l):e[i][5];o='<a href="http://'+e[i][5]+'" target="_blank" ><p>'+r+"</p></a>"}a+="<li><span><p>"+e[i][0]+"</p>"+s+"<p>"+e[i][1]+"</p><p>"+e[i][2]+"</p><p>"+e[i][3]+"</p><p>"+e[i][4]+"</p></a>"+o+"</span></li>"}return a+="</ul>"},inhalt=function(e,t){var a="";a+='<span class="scroll_positioner"></span><span class="ueandtx"><span class="ue">'+e[t].name,a+=e[t].time?" - "+adjustments_de.monthNames[e[t].time.from[1]-1]+" "+e[t].time.from[2]:"",a+=e[t].published?" - "+e[t].published.year:"";var i=get_column_count(e[t]),n='<i class="fa fa-download" aria-hidden="true"></i><i class="fa fa-pause" aria-hidden="true"></i><i class="fa fa-play" aria-hidden="true"></i><i class="fa fa-volume-off" aria-hidden="true"></i><i class="fa fa-volume-up" aria-hidden="true"></i><i class="fa fa-expand" aria-hidden="true"></i><i class="fa fa-eye" aria-hidden="true"></i><i class="fa fa-file-text-o" aria-hidden="true"></i>',s=n;a+='<span class="sh">'+s+'</span></span><span class="tx tx_out" style="-webkit-'+i+";-moz-"+i+";"+i+';">';var o=["",""];if("undefined"!=typeof e[t].map&&(o=['<div id="palma_map"></div>','<div style="height:400px;"></div>']),"undefined"!=typeof e[t].form){var l='<div class="timemachine" onmouseout="sh_dat.sh(this,0)" onmouseover="sh_dat.sh(this,1)">';l+='<span style="cursor:default;">'+adjustments_de.monthNames[avdays[0].getMonth()]+" / "+adjustments_de.monthNames[avdays[avdays.length-1].getMonth()]+"</span>";for(var r=0;r<avdays.length;r++){var d=0==avdays[r].getDay()||6==avdays[r].getDay()?' style="opacity:0.9;color:rgba(255,255,255,0.5);cursor:default;"':' onclick="write_day(this)"';l+="<span"+d+">"+avdays[r].getDate()+"</span>"}l+="</div>";var p="";p+='<span><i class="fa fa-check form_check form_check_white" aria-hidden="true" onclick="sh_dat.check(this)"></i><span style="margin: 0;">'+l+'<input placeholder="Terminvorschlag" type="text"/></span></span>';for(var c=[[5,0],[5,1],[5,2],[4,2]],h=0;h<c.length;h++){var f=folders[c[h][0]].data[c[h][1]];p+='<span><i class="fa fa-check form_check form_check_white" aria-hidden="true" onclick="shop.work(this)"></i><span style="width:180px;">'+f.name+'</span><span id="pr'+f.epilog.Bestellung[2]+'">CHF '+f.epilog.Bestellung[2]+'.00</span><input onchange="shop.calc(this)" onkeyup="shop.calc(this)" type="number" name="quantity" style="width:36px;" value="'+f.epilog.Bestellung[3]+'" /><img src="shop/'+f.comp_name+'.jpg" onclick="jump_to('+c[h][1]+","+c[h][0]+')" /></span>'}o=['<div id="palma_form"></div>','<div id="palma_shop" class="palma_shop_ini">'+p+"</div>",' style="height:2px;"','<h2 style="position:absolute;margin-top:176px;">Wollen Sie eine unserer Publikationen bestellen?</h2>']}var m=2==o.length?["",""]:[o[2],o[3]];if(a+=""==e[t].prolog?o[0]:o[0]+"<h2"+m[0]+">"+e[t].prolog+"</h2>"+m[1],a+=e[t].text+o[1]+"</span>","undefined"!=typeof e[t].epilog){e[t].epilog.Ausstellungsort&&Array.isArray(e[t].epilog.Ausstellungsort)&&(e[t].epilog.Ausstellungsort=plc(e[t].epilog.Ausstellungsort,e[t].time)),e[t].epilog.Projektort&&Array.isArray(e[t].epilog.Projektort)&&(e[t].epilog.Projektort=plc(e[t].epilog.Projektort,e[t].time)),e[t].epilog.Autoren&&Array.isArray(e[t].epilog.Autoren)&&(e[t].epilog.Autoren=aut(e[t].epilog.Autoren)),e[t].epilog.Autorinnen&&Array.isArray(e[t].epilog.Autorinnen)&&(e[t].epilog.Autorinnen=aut(e[t].epilog.Autorinnen));var u=0==chapter&&t>4?"Kontakt":"Einleitung";a+='<div class="epilog epilog_ini"><span onclick="sub_chapter(this)">'+u+"</span><br/>",a+=e[t].epilog.Ausstellungsort?'<span onclick="sub_chapter(this)">Orte und Daten</span><br/>':"",a+=e[t].epilog.Impressionen?'<span onclick="sub_chapter(this)">Impressionen</span><br/>':"",a+=e[t].epilog.Film?'<span onclick="sub_chapter(this)">Film</span><br/>':"",a+=e[t].epilog.Hören?'<span onclick="sub_chapter(this)">Hören</span><br/>':"",a+=e[t].epilog.Download?'<span onclick="download_pdf()">Download</span><br/>':"",a+=e[t].epilog.App?'<span onclick="show_app(0,this)">App</span><br/>':"";for(var _ in e[t].epilog)a+="Film"==_||"Hören"==_||"Impressionen"==_||"Download"==_||"Info"==_||"Ausstellungsort"==_||"App"==_?"":'<span onclick="sub_chapter(this)">'+_+"</span><br/>";a+="</div>"}return a+="</span>"},do_me=function(e,t){slide_lr(e,!0),sh_me(0),"undefined"!=typeof t&&hear_audio("mediaguides/",t)},mpt,sh_me=function(e,t,a){return 0==e?void(mpt.style.visibility="hidden"):(mpt.innerHTML=t,mpt.style.visibility="visible",mpt.style.marginLeft=a.offsetLeft-mpt.offsetWidth/2-412+"px",void(mpt.style.marginTop=a.offsetTop-278+"px"))},show_app=function(e,t){console.log("show_app z663: app_display_data.act_app ",app_display_data.act_app),"undefined"!=typeof t&&(set_epi_menu_color(t),console.log("sh_cheese"),sh_cheese(t.parentNode.parentNode,0)),e=0==e?"":"_"+e,app_display_data.act_app=folders[chapter].data[folders[chapter].last_position].comp_name,loadXMLDoc("mediaguides/"+app_display_data.act_app+e+".html",function(){if(4==xmlhttp.readyState&&200==xmlhttp.status){if(document.getElementsByClassName("epilog")[folders[chapter].last_position].previousSibling.innerHTML='<span id="map_place_title"></span>'+xmlhttp.responseText+'<div class="app_leftside"></div><div class="app_beside">'+app_display_data[app_display_data.act_app].apendix()+"</div>",mpt=document.getElementById("map_place_title"),"maxfrisch"==folders[chapter].data[folders[chapter].last_position].comp_name&&""!=e){document.getElementsByClassName("app_leftside")[0].addEventListener("click",function(){show_app(0)},!1),document.getElementsByClassName("app_leftside")[0].innerHTML="<br/>zurück zu den anderen Spaziergängen",document.getElementsByClassName("app_leftside")[0].style.display="inline-block",document.getElementsByClassName("app_beside")[0].children[0].innerHTML="Clicken Sie auf die Stationen der Karte.",document.getElementById("map_canvas").scrollLeft=420,document.getElementById("map_canvas").scrollTop=220;for(var t=document.getElementsByClassName("pri")[0].getElementsByTagName("div"),a=0;a<app_display_data[app_display_data.act_app].img_ix.length;a++)t[a].ix=a,t[a].addEventListener("click",function(){do_me(app_display_data[app_display_data.act_app].img_ix[this.ix],"maxfrisch_1_"+parseInt(this.ix+1))},!1),t[a].addEventListener("mouseover",function(){sh_me(1,app_display_data[app_display_data.act_app].plc_tx[this.ix],this)},!1),t[a].addEventListener("mouseout",function(){sh_me(0)},!1)}"monteverita"==folders[chapter].data[folders[chapter].last_position].comp_name&&do_cords()}})},download_pdf=function(){var e=folders[chapter].data,t=""==e[folders[chapter].last_position].prolog?"":"<h2>"+e[folders[chapter].last_position].prolog+"</h2>",a="<p>"+e[folders[chapter].last_position].name+"</p><p>"+t+"</p><p>"+e[folders[chapter].last_position].text+"</p><hr/><p>Ausstellungskonzept</p>"+e[folders[chapter].last_position].epilog.Ausstellungskonzept+"<hr/><p>Ausstellungsort</p><p>"+e[folders[chapter].last_position].epilog.Ausstellungsort+"</p>",i=document.createElement("div");i.innerHTML=a,i.className="prepdf",document.getElementById("chapter_content").appendChild(i);for(var n=0,s=window.innerWidth<950?600:500,o=window.innerWidth<950?6:15,l=window.innerWidth<950?198:180,r=0;r<i.children.length;r++)if(i.children[r].offsetTop+i.children[r].offsetHeight>n+s){var d=document.createElement("span");d.className="cut",i.insertBefore(d,i.children[r]),n+=s}a=i.innerHTML,document.getElementById("chapter_content").removeChild(i),i=null;for(var p=a.split('<span class="cut"></span>'),c=new jsPDF,h={},f=0;f<p.length;f++){var i=document.createElement("div");i.innerHTML=p[f],i.className="prepdf",document.getElementById("chapter_content").appendChild(i),f>0&&c.addPage(),c.setPage(f+1),c.fromHTML(i,o,o,{width:l,elementHandlers:h}),document.getElementById("chapter_content").removeChild(i)}c.output("dataurlnewwindow")},bilder=function(){for(var e=folders[chapter].data,t=[],a=0;a<e.length;a++)t.push(e[a].bilder);return t},white_head=function(){clearTimeout(sivId),sivId=setTimeout(function(){for(var e=get_page_scroll_position(),t=document.getElementsByClassName("ueandtx"),a=[],i=0;i<t.length;i++){var n=parseInt(t[i].offsetTop+210+t[i].offsetHeight/2);switch(!0){case n<e+210:a.push(t[i].offsetTop+t[i].offsetHeight);break;case n>e+210+window.innerHeight:a.push(t[i].offsetTop+parseInt((window.innerHeight-210)/2));break;default:a.push(n)}}var s=getNearestNumber(a,e+window.innerHeight/2+240);return folders[chapter].last_position==s&&chapter==old_chapter?void console.log("ireturn in middle of white_head"):(old_chapter=chapter,folders[chapter].last_position=s,document.getElementById("chapter_content").style.height="auto",change_image(folders[chapter].data[folders[chapter].last_position].comp_name+"_"+folders[chapter].data[folders[chapter].last_position].slid_count),document.getElementsByClassName("fa-angle-left")[0].style.display=document.getElementsByClassName("fa-angle-right")[0].style.display="hidden"==t[folders[chapter].last_position].children[1].style.visibility&&folders[chapter].data[folders[chapter].last_position].epilog.Impressionen&&!isTouchSupported()&&"closed"==folders[chapter].data[folders[chapter].last_position].video.playstate?"block":"none","undefined"!=typeof folders[chapter].data[s].form&&loadForm(),"undefined"!=typeof folders[chapter].data[s].map?loadMap():(map=null,document.getElementById("palma_map")&&(document.getElementById("palma_map").innerHTML="")),void(document.getElementsByClassName("cheese")[0]&&(folders[chapter].last_position>0&&(sh_cheese(t[folders[chapter].last_position-1],0),1==folders[chapter].data[folders[chapter].last_position-1].see_read_state&&(t[folders[chapter].last_position-1].style.background="rgba(255,255,255,0)")),sh_cheese(t[folders[chapter].last_position],1),folders[chapter].last_position<t.length-1&&(sh_cheese(t[folders[chapter].last_position+1],0),1==folders[chapter].data[folders[chapter].last_position+1].see_read_state&&(t[folders[chapter].last_position+1].style.background="rgba(255,255,255,0)")))))},100)},load_media=function(){var e="media/"+folders[chapter].name+"/"+folders[chapter].data[folders[chapter].last_position].comp_name+"/";loadXMLDoc(e+"media.txt?zuza"+Math.floor(1e3*Math.random()+1),function(){if(4==xmlhttp.readyState&&200==xmlhttp.status){var t=JSON.parse(xmlhttp.responseText),a="<ul>";for(var i in t){var n=isNaN(i)?'href="'+e+i+'.pdf" target="_blank"':'onclick="parent_media(this,'+i+')"';switch(t[i][3].toLowerCase()){case"pdf":var s='<i class="fa fa-file-pdf-o" aria-hidden="true"></i>';break;case"video":var s='<i class="fa fa-film" aria-hidden="true"></i>';break;case"audio":var s='<i class="fa fa-volume-up" aria-hidden="true""></i>';break;default:var s=t[i][3]+", "}a+='<li><span style="display: inline-table;"><p style="margin-left: 8px;">'+t[i][0]+'</p><p><a style="padding: 14px 8px 6px 8px;" '+n+">"+s+t[i][1]+", "+t[i][2]+"</a></p></span></il>"}a+="</ul>",folders[chapter].data[folders[chapter].last_position].epilog.Medienberichte=a}})},change_image=function(e){folders[chapter].data[folders[chapter].last_position].epilog.Medienberichte&&folders[chapter].data[folders[chapter].last_position].epilog.Medienberichte===!0&&load_media(),e=e.replace("_0",""),"undefined"!=typeof video_controls.prev_vid&&folders[video_controls.prev_vid[0]].data[video_controls.prev_vid[1]].video.src!=folders[chapter].data[folders[chapter].last_position].comp_name&&video_controls.hide(),"open"==folders[chapter].data[folders[chapter].last_position].video.playstate&&(video_controls.act_src!=folders[chapter].data[folders[chapter].last_position].comp_name?show_video(folders[chapter].data[folders[chapter].last_position].comp_name):video_controls.run());var t=new Image;t.onerror=function(){change_image("default")},t.onload=function(){document.getElementById("hg_cover").style.backgroundImage='url("images/'+folders[chapter].name+"/"+e+'.jpg")',fade_img("hg_cover","hg")},t.src="images/"+folders[chapter].name+"/"+e+".jpg"},sh_epi=function(){for(var e=document.getElementsByClassName("epilog"),t=0;t<e.length;t++)t!=folders[chapter].last_position?(e[t].previousSibling.classList.remove("tx_in"),e[t].previousSibling.classList.add("tx_out"),e[t].classList.remove("change_img_in"),e[t].classList.add("change_img_out"),e[t].style.visibility="hidden"):(0==folders[chapter].data[t].see_read_state&&(e[t].style.visibility="visible"),e[t].previousSibling.classList.remove("tx_out"),e[t].previousSibling.classList.add("tx_in"),e[t].classList.remove("change_img_out"),e[t].classList.add("change_img_in"))};fade_img=function(e,t){sh_epi();var e=document.getElementById(e);e.classList.add("change_img_in"),setTimeout(function(){document.getElementById(t).style.backgroundImage=e.style.backgroundImage,e.classList.remove("change_img_in")},400)};var vid="",video_controls={act_src:"",run:function(){""!=aud&&(media_kind="v",aud.pause()),folders[chapter].data[folders[chapter].last_position].video.playstate="open",vid.ontimeupdate=function(){folders[video_controls.prev_vid[0]].data[video_controls.prev_vid[1]].video.time=vid.currentTime},vid.currentTime=folders[chapter].data[folders[chapter].last_position].video.time<vid.duration-2?folders[chapter].data[folders[chapter].last_position].video.time:0,this.prev_vid=[chapter,folders[chapter].last_position],vid.play(),this.show()},pause:function(){""!=vid&&vid.pause()},mute:function(){vid.muted=!0},unmute:function(){vid.muted=!1},show:function(){fade_mov("hg_media","in")},hide:function(){fade_mov("hg_media","out"),"closed"==folders[chapter].data[folders[chapter].last_position].video.playstate&&hide_media_icons(),this.pause()}},show_video=function(e){""!=folders[chapter].data[folders[chapter].last_position].video.src&&video_controls.act_src==e||(folders[chapter].data[folders[chapter].last_position].video.src=video_controls.act_src=e,document.getElementById("hg_media").innerHTML='<video id="actual_video"/ ><source src="images/'+folders[chapter].name+"/"+e+'.mp4" type="video/mp4" ></video>',vid=document.getElementById("actual_video"),vid.autoplay=!1),setTimeout(function(){video_controls.run(),fade_mov("hg_media","in")},1e3)};fade_mov=function(e,t){var e=document.getElementById(e);"out"==t?(sh_epi(),e.classList.remove("change_img_in"),e.classList.add("change_img_out")):(size_video(),e.classList.remove("change_img_out"),e.classList.add("change_img_in"),document.getElementsByClassName("fa-angle-left")[0].style.display=document.getElementsByClassName("fa-angle-right")[0].style.display="none",hide_media_icons(),document.getElementsByClassName("fa-pause")[folders[chapter].last_position].style.display=document.getElementsByClassName("fa-expand")[folders[chapter].last_position].style.display="inline-block",document.getElementsByClassName("fa-volume-up")[folders[chapter].last_position].style.display=vid.muted?"inline-block":"none",document.getElementsByClassName("fa-volume-off")[folders[chapter].last_position].style.display=vid.muted?"none":"inline-block")},size_video=function(){vid.aspectRatio=vid.videoWidth/vid.videoHeight,console.log("vid.aspectRatio ",vid.aspectRatio),console.log("Width/Height-180 ",window.innerWidth/(window.innerHeight-180)),vid.aspectRatio>=window.innerWidth/(window.innerHeight-180)?(vid.style.width="auto",vid.style.height="100%"):(vid.style.width="100%",vid.style.height="auto")},hide_media_icons=function(){for(var e=document.getElementsByClassName("fa-pause"),t=0;t<e.length;t++)e[t].style.display=e[t].nextSibling.style.display=e[t].nextSibling.nextSibling.style.display=e[t].nextSibling.nextSibling.nextSibling.style.display=e[t].nextSibling.nextSibling.nextSibling.nextSibling.style.display="none";"a"==media_kind&&(aud.paused?(document.getElementsByClassName("fa-pause")[folders[chapter].last_position].style.display="none",document.getElementsByClassName("fa-play")[folders[chapter].last_position].style.display="inline-block"):(document.getElementsByClassName("fa-pause")[folders[chapter].last_position].style.display="inline-block",document.getElementsByClassName("fa-play")[folders[chapter].last_position].style.display="none"))};var aud="",media_kind="v";hear_audio=function(e,t){document.getElementById("hg_audio").innerHTML='<audio id="actual_audio" ><source src="'+e+"/"+t+'.mp3" type="audio/mpeg" ></audio>',media_kind="a",aud=document.getElementById("actual_audio"),aud.play(),hide_media_icons()};var jump_to=function(e,t){return jump_destination=!1,document.getElementById("chapter_menu").style.display="none",folders[t].last_position=e,t==chapter?void hit_menue(t,-1):void hit_menue(t)},hit_menue=function(e,t){found.classList.remove("found_in_out"),found.style.display="none";var a=folders[chapter].last_position,i=document.getElementsByClassName("items");isNaN(e)||(e=document.getElementsByClassName("items")[e]);for(var n=0;n<i.length;n++)if(i[n].style.color="#333",i[n]==e&&(isTouchSupported()&&(disable_cine=!0),old_chapter="undefined"==typeof t?chapter:t,chapter=n,i[chapter].style.color="#bc123a","undefined"==typeof t)){for(var s="",o=0;o<folders[chapter].data.length;o++)s+=inhalt(folders[chapter].data,o);document.getElementById("chapter_content").style.height=get_page_scroll_position()+window.innerHeight+"px",document.getElementById("chapter_content").innerHTML=s}document.getElementById("hg_cover").style.display="block";for(var l=document.getElementsByClassName("ueandtx"),n=0;n<l.length;n++)"undefined"==typeof folders[chapter].data[n].slid_count&&(folders[chapter].data[n].slid_count=0),"undefined"==typeof folders[chapter].data[n].see_read_state&&(folders[chapter].data[n].see_read_state=0);if(toggle_favicons(),"undefined"==typeof folders[chapter].data[0].bilder){for(var n=0;n<l.length;n++)folders[chapter].data[n].bilder=[];clearInterval(foimId),foimId=setInterval(function(){1==preload_images.folder_imgs&&(clearInterval(foimId),preload_images.folder_imgs=!1,document.getElementsByClassName("scroll_positioner")[folders[chapter].last_position].scrollIntoView({block:"start",behavior:"smooth"}),folders[chapter].last_position==a&&change_image(folders[chapter].data[folders[chapter].last_position].comp_name+"_"+folders[chapter].data[folders[chapter].last_position].slid_count),setTimeout(function(){display_prel.classList.remove("preloaded_on"),display_prel.classList.add("preloaded_off")},1e3))},100),display_prel.classList.remove("preloaded_ini"),display_prel.classList.remove("preloaded_off"),display_prel.classList.add("preloaded_on"),preload_images.get_arrays("sub",folders[chapter],"name")}else document.getElementsByClassName("scroll_positioner")[folders[chapter].last_position].scrollIntoView({block:"start",behavior:"smooth"}),folders[chapter].last_position==a&&change_image(folders[chapter].data[folders[chapter].last_position].comp_name+"_"+folders[chapter].data[folders[chapter].last_position].slid_count);document.getElementById("header_txt").innerHTML=folders[chapter].intro},see=function(e,t,a){var i=e.ix;folders[chapter].data[i].see_read_state=t,1==t?(isTouchSupported()&&(disable_cine=!1),e.style.display="none",e.nextSibling.style.display="inline-block",e.parentNode.style.marginTop="-42px",e.parentNode.parentNode.style.fontSize="3.6vw",e.parentNode.parentNode.style.textIndent="40px",e.parentNode.parentNode.style.background="rgba(191, 191, 191, 0.6)",e.parentNode.parentNode.style.marginTop="180px",e.parentNode.parentNode.style.borderTop="18px solid rgba(0, 0, 0, 0)",e.parentNode.parentNode.nextSibling.nextSibling&&(e.parentNode.parentNode.nextSibling.nextSibling.style.visibility="hidden"),e.parentNode.parentNode.nextSibling.style.visibility="hidden",e.parentNode.parentNode.parentNode.style.background="rgba(255,255,255,0)",e.parentNode.parentNode.parentNode.style.height=parseInt(window.innerHeight-60)+"px",document.getElementsByClassName("scroll_positioner")[i].style.marginTop=a+"px",folders[chapter].data[i].video,folders[chapter].data[i].epilog.Impressionen&&!isTouchSupported()&&"closed"==folders[chapter].data[i].video.playstate&&(document.getElementsByClassName("fa-angle-left")[0].style.display=document.getElementsByClassName("fa-angle-right")[0].style.display="block"),sh_cheese(e.parentNode.parentNode.parentNode,0)):(isTouchSupported()&&(disable_cine=!0),e.style.display="none",e.previousSibling.style.display="inline-block",e.parentNode.style.marginTop="-36px",e.parentNode.parentNode.style.fontSize="28px",e.parentNode.parentNode.style.textIndent=0,e.parentNode.parentNode.style.background="rgba(0, 0, 0, 0)",e.parentNode.parentNode.style.marginTop="0",e.parentNode.parentNode.style.borderTop="0 none",e.parentNode.parentNode.nextSibling.style.visibility="visible",e.parentNode.parentNode.nextSibling.style.filter="none",e.parentNode.parentNode.nextSibling.style.color="#333",e.parentNode.parentNode.nextSibling.nextSibling&&(e.parentNode.parentNode.nextSibling.nextSibling.style.visibility="visible"),e.parentNode.parentNode.parentNode.style.background="rgba(255,255,255,0.9)",e.parentNode.parentNode.parentNode.style.height="auto",e.parentNode.parentNode.parentNode.offsetHeight<parseInt((window.innerHeight-300)/2)&&(e.parentNode.parentNode.parentNode.style.height=parseInt((window.innerHeight-300)/2)+"px"),document.getElementsByClassName("scroll_positioner")[i].style.marginTop="calc(180px - 50vh)",window.scrollTo(0,e.parentNode.parentNode.parentNode.previousSibling.offsetTop),document.getElementsByClassName("fa-angle-left")[0].style.display=document.getElementsByClassName("fa-angle-right")[0].style.display="none",app_display_data.act_app==folders[chapter].data[i].comp_name?sh_cheese(e.parentNode.parentNode.parentNode,0):sh_cheese(e.parentNode.parentNode.parentNode,1))},sh_cheese=function(e,t){if(e.getElementsByClassName("cheese")[0])if(1==t){if(folders[chapter].data[folders[chapter].last_position].imp_cheese_state){if(e.style.background="rgba(0,0,0,0)",0==folders[chapter].data[folders[chapter].last_position].see_read_state){e.getElementsByClassName("cheese")[0].style.display="block";var a=window.innerWidth-260,i=calc_min_slid_height(e.getElementsByClassName("epilog")[0].children.length);draw_cheese_canvas(e.getElementsByClassName("cheese")[0],a,i)}e.getElementsByClassName("imp_slid")[0]&&(e.getElementsByClassName("imp_slid")[0].style.WebkitAnimationPlayState="running",e.getElementsByClassName("imp_slid")[0].style.animationPlayState="running")}}else 0==folders[chapter].data[folders[chapter].last_position].see_read_state&&(e.style.background="rgba(255,255,255,0.9)"),e.getElementsByClassName("cheese")[0].style.display="none",e.getElementsByClassName("imp_slid")[0]&&(e.getElementsByClassName("imp_slid")[0].style.WebkitAnimationPlayState="paused",e.getElementsByClassName("imp_slid")[0].style.animationPlayState="paused")},toggle_favicons=function(){for(var e=document.getElementsByClassName("fa-download"),t=document.getElementsByClassName("fa-eye"),a=document.getElementsByClassName("fa-file-text-o"),i=document.getElementsByClassName("fa-pause"),n=document.getElementsByClassName("fa-play"),s=document.getElementsByClassName("fa-volume-off"),o=document.getElementsByClassName("fa-volume-up"),l=document.getElementsByClassName("fa-expand"),r=0;r<t.length;r++)e[r].ix=t[r].ix=a[r].ix=s[r].ix=o[r].ix=r,e[r].style.visibility=0==chapter?"hidden":"visible",
e[r].addEventListener("click",function(){if(confirm('Möchten Sie das PDF Datenblatt von "'+folders[chapter].data[this.ix].name+'"\n(Einleitung, Ausstellungskonzept, Ausstellungsort und Datum, ohne Bilder)\nherunterladen / speichern?'))return void download_pdf()},!1),t[r].addEventListener("click",function(){see(this,1,-210),window.scrollTo(0,this.parentNode.parentNode.nextSibling.offsetTop-102)},!1),1==folders[chapter].data[r].see_read_state&&see(t[r],1,-26),a[r].addEventListener("click",function(){see(this,0),folders[chapter].data[folders[chapter].last_position].video.playstate="closed",video_controls.hide()},!1),i[r].addEventListener("click",function(){this.style.display="none",this.nextSibling.style.display="inline-block","v"==media_kind?(folders[chapter].data[folders[chapter].last_position].video.playstate="open",video_controls.pause()):(folders[chapter].data[folders[chapter].last_position].audio.time=aud.currentTime,aud.pause())},!1),n[r].addEventListener("click",function(){this.style.display="none",this.previousSibling.style.display="inline-block","v"==media_kind?(folders[chapter].data[folders[chapter].last_position].video.playstate="open",video_controls.run()):aud.play()},!1),s[r].addEventListener("click",function(){""!=vid&&(this.style.display="none",this.nextSibling.style.display="inline-block",vid.muted=!0)},!1),o[r].addEventListener("click",function(){""!=vid&&(this.style.display="none",this.previousSibling.style.display="inline-block",vid.muted=!1)},!1),l[r].addEventListener("click",function(){""!=vid&&toggleFullScreen()},!1)},slide_lr=function(e,t){if("closed"==folders[chapter].data[folders[chapter].last_position].video.playstate&&"bestellen"!=folders[chapter].data[folders[chapter].last_position].comp_name){if(0==folders[chapter].data[folders[chapter].last_position].see_read_state){var a=document.getElementsByClassName("fa-eye")[folders[chapter].last_position];a.ix=folders[chapter].last_position,see(a,1,-210),window.scrollTo(0,a.parentNode.parentNode.nextSibling.offsetTop-102)}if(e==-1)folders[chapter].data[folders[chapter].last_position].slid_count--,folders[chapter].data[folders[chapter].last_position].slid_count<0&&(folders[chapter].data[folders[chapter].last_position].slid_count=bilder()[folders[chapter].last_position].length);else{if(e>1||t)return folders[chapter].data[folders[chapter].last_position].slid_count=e,void change_image(folders[chapter].data[folders[chapter].last_position].comp_name+"_"+e);folders[chapter].data[folders[chapter].last_position].slid_count++,folders[chapter].data[folders[chapter].last_position].slid_count>bilder()[folders[chapter].last_position].length&&(folders[chapter].data[folders[chapter].last_position].slid_count=0)}change_image(folders[chapter].data[folders[chapter].last_position].comp_name+"_"+folders[chapter].data[folders[chapter].last_position].slid_count)}},search_nostyle=function(e){var t=!1;if("string"==typeof e){var a=e.toLowerCase().replace(/ /g,"");t=!0}else var a=e.innerHTML.toLowerCase().replace(/ /g,"").replace("(palma3)","");e:for(var i=0;i<folders.length;i++)for(var n=0;n<folders[i].data.length;n++)for(key in folders[i].data[n])if(folders[i].data[n].search.indexOf(a)!=-1){if(t){t=!1;var s=[n,i];return s}jump_to(n,i);break e}if(t){var s=[0];return s}},search=function(e){e.parentNode.style.border="2px solid #bc123a",e.nextSibling.nextSibling.style.display="none",e.nextSibling.style.display="none",found.classList.remove("found_in_out"),found.style.display="none";var t=e.value.toLowerCase().replace(/ /g,"");e:for(var a=0;a<folders.length;a++)for(var i=0;i<folders[a].data.length;i++)for(key in folders[a].data[i])if(folders[a].data[i].search.indexOf(t)!=-1){if(a>0){found.innerHTML='<a onclick="jump_to('+i+", "+a+');">'+folders[a].data[i].name+"</a>";var n=document.getElementsByClassName("items")[a];found.style.display="block",found.style.left=n.getBoundingClientRect().left+n.offsetWidth/2-found.offsetWidth/2+"px",found.classList.add("found_in_out")}e.parentNode.style.border="2px solid rgba(127, 127, 127, 0.2)",e.nextSibling.nextSibling.style.display="inline-block",e.nextSibling.style.display="inline-block",e.nextSibling.nextSibling.ix=i,e.nextSibling.nextSibling.fx=a,e.nextSibling.nextSibling.onclick=function(){jump_to(this.ix,this.fx)},jump_destination=[i,a];break e}},jump_destination=!1,arrow=function(e){"none"!=document.getElementById("chapter_menu").style.display,e||(e=window.event),37==e.keyCode&&slide_lr(-1),39==e.keyCode&&slide_lr(1),jump_destination&&13==e.keyCode&&jump_to(jump_destination[0],jump_destination[1])},text_load=function(){loadXMLDoc("inhalt.js",function(){4==xmlhttp.readyState&&(200==xmlhttp.status?(folders=JSON.parse(xmlhttp.responseText).folders,page_load()):alert("inhalt shit happens"))})},page_load=function(){wlh=window.location.href,display_prel=document.getElementById("preloaded"),found=document.getElementById("found");for(var t=0;t<folders.length;t++){for(var a=0;a<folders[t].data.length;a++)folders[t].data[a].video={time:0,playstate:"closed",mutestate:"unmuted",src:""},folders[t].data[a].audio={time:0,src:""},folders[t].data[a].search.push(folders[t].data[a].comp_name),folders[t].data[a].name.toLowerCase().replace(/ /g,"")!=folders[t].data[a].comp_name&&folders[t].data[a].search.push(folders[t].data[a].name.toLowerCase().replace(/ /g,""));"undefined"!=typeof folders[t].data[0].time&&folders[t].data.sort(function(e,t){return t.time.from[2]-e.time.from[2]});var i=document.createElement("div");i.className="items",i.ix=t,i.innerHTML=folders[t].menu_name,i.addEventListener("click",function(){hit_menue(this)},!1),folders[t].menu_ih='<span style="display:inline-block;">',folders[t].menu_ih+=0==t?'<p><input type="text" onkeyup="search(this)" placeholder=" ... in Palma3 suchen" /><i class="fa fa-check search_check" aria-hidden="true"></i><i class="fa fa-arrow-circle-right" aria-hidden="true"></i></p>':"";for(var n=0;n<folders[t].data.length;n++)folders[t].menu_ih+='<p onclick="jump_to('+n+","+t+')">'+folders[t].data[n].name+"</p>";folders[t].menu_ih+="</span>",i.addEventListener("mouseover",function(){var e=document.getElementById("chapter_menu");if(e.innerHTML=folders[this.ix].menu_ih,""!=folders[this.ix].menu_ih){e.style.display="block";var t=e.children[0].lastElementChild.getBoundingClientRect().bottom;t>window.innerHeight-210&&(e.children[0].style.maxHeight=window.innerHeight-210+"px",e.children[0].style.overflowY="scroll");var a=parseInt(this.getBoundingClientRect().left-e.offsetWidth/2+this.offsetWidth/2);e.style.marginLeft=a>0?a+"px":"0"}0==this.ix&&e.children[0].children[0].children[0].focus()},!1),document.getElementById("content").appendChild(i),document.getElementById("chapter_content").addEventListener("mouseover",function(){document.getElementById("chapter_menu").style.display="none"},!1),folders[t].last_position=0}return document.getElementById("chapter_menu").addEventListener("mouseout",function(t){e=t.toElement||t.relatedTarget,null!=e&&e.parentNode.parentNode.parentNode!=this&&e.parentNode.parentNode!=this&&e.parentNode!=this&&e!=this&&(this.style.display="none")},!1),window.addEventListener("resize",align_onresize,!1),window.addEventListener("scroll",white_head,!1),document.getElementById("header_palma").addEventListener("click",page_reload,!1),document.getElementsByClassName("fa-angle-left")[0].addEventListener("click",function(){slide_lr(-1)},!1),document.getElementsByClassName("fa-angle-right")[0].addEventListener("click",function(){slide_lr(1)},!1),isTouchSupported()?void get_cine_script():(window.addEventListener("keydown",arrow,!1),void preload_images.get_arrays("kind",folders,"name"))};document.addEventListener("DOMContentLoaded",text_load,!1);