<!DOCTYPE html>
<html>

	<head>

		<meta charset="utf-8" />

		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

		<meta name="viewport" id="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />

		<meta name="mobile-web-app-capable" content="yes" />

		<meta name="apple-mobile-web-app-capable" content="yes" />

		<meta name="apple-mobile-web-app-status-bar-style" content="white" />

		<title>Emil Zbinden Panorama</title>

		<link rel="shortcut icon" href="images/favicon.ico" />

		<link rel="stylesheet" href="../font-awesome-4.6.3/css/font-awesome.min.css" />

		<style>
			html,
			body {
				position: absolute;
				width: 100%;
				height: 100%;
				margin: 0;
				padding: 0;
			}

			a {
				color: #bc123a;
				text-decoration: underline;
			}

			#panorama {
				position: absolute;
				width: 960px;
				left: calc(50vw - 480px);
				overflow: auto;
				bottom: 200px;
				height: calc(100vh - 400px);
				/*
				display: inline-block;
*/
				display: flex;
				justify-content: center;
			}

			#panorama img,
			#panorama .img_over_left,
			#panorama .img_over_right {
				height: 100%;
				border: 0 none;
				margin: 0;
				padding: 0;
				top: 0;
				display: block;
				position: absolute;
			}

			#panorama img {
				width: auto;
    -webkit-user-select: none; /* Chrome, Opera, Safari */
    -moz-user-select: none; /* Firefox 2+ */
    -ms-user-select: none; /* IE 10+ */
    user-select: none; /* Standard syntax */
			}

			#panorama video {
				width: 100vw;
			}

			#panorama .img_over_left {
				width: 50%;
				cursor: url("images/sys/left.png"), url("images/sys/left.cur"), move;
				z-index: 1;
			}

			#panorama .img_over_right {
				width: 50%;
				cursor: url("images/sys/right.png"), url("images/sys/right.cur"), move;
				z-index: 1;
				right: 0;
			}

			.fa-times-thin:before {
				content: '\00d7';
			}

			.fa-times-thin {
				position: absolute;
				right: 0;
				padding: 12px;
				font-size: 48px;
				line-height: 24px;
			}

			.fa {
				cursor: pointer;
				color: #ccc;
				font-size: 48px;
			}
		</style>

		<script type="text/javascript">
			var dimensionFunction = function() {

				var i = document.getElementsByTagName('video')[0];
				i.controls = "controls";
				i.play();

			};

			var out_click = function(e) {
				console.log(e.target.className);
				if (e.target.tagName.toLowerCase() == 'body' || e.target.className == 'fa fa-times-thin') {
					this.location.href = 'empty.html';
					console.log('now please close this iframe', this.location.href);
				}
			};

			var slide_image = {
				"count": 0,
				"mouse": function(t) {
					this.count = parent.index_in_parent(t);
console.log(this.count);



				},
				"left": function(t) {
					this.count--;
					if (this.count < 0) {
						this.count = parent.images_arr.length - 1;
					}
					t.parentNode.children[2].src = 'images/' + parent.images_arr[this.count] + '.jpg';
				},
				"right": function(t) {
					this.count++;
					if (this.count > parent.images_arr.length - 1) {
						this.count = 0;
					}
					t.parentNode.children[2].src = 'images/' + parent.images_arr[this.count] + '.jpg';
				}
			};


			var img_load = function() {

				var q = window.location.search.substring(1);


				var obj = {};
				var pairs = q.split('&');
				for (a in pairs) {
					var split = pairs[a].split('=');
					obj[decodeURIComponent(split[0])] = decodeURIComponent(split[1]);
				}

				if (obj.type == 'mp4') {

					var i = document.createElement('video');

					i.innerHTML = '<source src="images/' + obj.name + '.mp4" type="video/mp4">Your browser does not support the video tag.';

					document.getElementById('panorama').appendChild(i);

					//i.onloadedmetadata = function(){

					//};


					i.addEventListener("canplaythrough", dimensionFunction, false);

				} else {


					var i = document.createElement('img');

					i.src = 'images/' + obj.name + '.' + obj.type;

					i.addEventListener('click', function() {

					}, false);

					document.getElementById('panorama').appendChild(i);

				}

			};

			document.addEventListener('DOMContentLoaded', img_load, false);
		</script>


	</head>

	<body onclick="out_click(event)">
		<div id="panorama">
			<div class="img_over_left" onclick="slide_image.left(this)" onmouseover="slide_image.mouse(this)"></div>
			<div class="img_over_right" onclick="slide_image.right(this)" onmouseover="slide_image.mouse(this)"></div>
		</div>
		<i class="fa fa-times-thin" aria-hidden="true"></i>
	</body>

</html>